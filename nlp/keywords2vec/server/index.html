<!DOCTYPE html>
<html>
<head>
  <title></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css" integrity="sha256-dMQYvN6BU9M4mHK94P22cZ4dPGTSGOVP41yVXvXatws=" crossorigin="anonymous" />
  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <style>
    h1{
      margin: 40px 0;
      font-weight: bold;
      font-size: 1.2em;
    }
    input[type="text"] {
      text-transform: lowercase;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="section">
      <h1>Explore the word2vec vectors</h1>
      <div class="field">
        <div class="control">
          Positive keywords (Use comma for multiple). Example: heart failure 
          <input class="input is-primary positive" type="text" placeholder="Positive keywords">
        </div>
      </div>
      <div class="field">
        Negative keywords (Use comma for multiple)
        <div class="control">
          <input class="input is-primary negative" type="text" placeholder="Negative keywords">
        </div>
      </div>
      <div class="field">
        Number of results
        <div class="control">
          <input class="input is-primary size" value="50" type="text" placeholder="Total results">
        </div>
      </div>
      <div class="error-messages"></div>
      <div><a class="button keywords-btn">Get keywords</a></div>
      <div style="margin-top: 20px" class="results columns is-gapless is-multiline is-mobile"></div>
    </div>
  </div>
  <script>
    var keywords = []
    var retrieveResults = function(){
      var positive = jQuery(".positive").val().toLowerCase()
      var negative = jQuery(".negative").val().toLowerCase()
      var size = jQuery(".size").val()
      jQuery(".error-messages").html("")
      jQuery.ajax("/keywords/similars?positive="+positive+"&negative="+negative+"&size="+size).done(function(data) {
        var htmlText = ""
        jQuery.each(data, function(index, row){
          htmlText += '<div class="card column is-half"><div class="card-content"><p class="title">'
          htmlText += row[0]
          htmlText += "</p></div></div>"
        });
        jQuery(".results").html(htmlText);
      }).fail(function(){
        jQuery(".error-messages").html("Couldn't find the keyword")
      })
    }
    jQuery(document).ready(function(){
      jQuery(".keywords-btn").click(retrieveResults);
      jQuery.ajax("/keywords/all").done(function(data) {
        keywords = data;
        window.keywords = keywords;
      })
      jQuery(".positive").keypress(function (e) {
        if (e.which == 13) {
          retrieveResults()
          return false;
        }
      });
      jQuery(".negative").keypress(function (e) {
        if (e.which == 13) {
          retrieveResults()
          return false;
        }
      });
    })
  </script>
</body>
</html>